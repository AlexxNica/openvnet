lxc.utsname = <%= @vm[:name] %>

<%- @vm[:interfaces].each do |i| -%>
lxc.network.type = veth
lxc.network.flags = up
lxc.network.name = <%= i[:name] %>
lxc.network.link = <%= i[:bridge] || "lxcbr0" %>
<%= "#" unless i[:mac_address] %>lxc.network.hwaddr = <%= i[:mac_address]} %>
<%= "#" unless i[:ipv4_address] %>lxc.network.ipv4 = <%= i[:ipv4_address]} %>
<%= "#" unless i[:port_name] %>lxc.network.veth.pair = <%= i[:port_name]}" %>
<%- end -%>

lxc.tty = 1
lxc.pts = 1024
lxc.rootfs = /var/lib/lxc/<%= vm[:name] %>/rootfs
lxc.mount  = /var/lib/lxc/<%= vm[:name] %>/fstab
lxc.arch = x86_64
lxc.cap.drop = sys_module mac_admin

lxc.cgroup.devices.deny = a
lxc.cgroup.devices.allow = c *:* m
lxc.cgroup.devices.allow = b *:* m
lxc.cgroup.devices.allow = c 1:3 rwm
lxc.cgroup.devices.allow = c 1:5 rwm
lxc.cgroup.devices.allow = c 5:1 rwm
lxc.cgroup.devices.allow = c 5:0 rwm
lxc.cgroup.devices.allow = c 1:9 rwm
lxc.cgroup.devices.allow = c 1:8 rwm
lxc.cgroup.devices.allow = c 136:* rwm
lxc.cgroup.devices.allow = c 5:2 rwm
lxc.cgroup.devices.allow = c 254:0 rwm
lxc.cgroup.devices.allow = c 10:229 rwm
lxc.cgroup.devices.allow = c 10:200 rwm
lxc.cgroup.devices.allow = c 1:7 rwm
lxc.cgroup.devices.allow = c 10:228 rwm
lxc.cgroup.devices.allow = c 10:232 rwm
