# -*- coding: utf-8 -*-
require 'spec_helper'

describe Vnet::NodeModules::DatabaseMediator do

  subject { Vnet::NodeModules::DatabaseMediator.new }

  context "when an entry is created on the network table of the vdc" do

    let(:model_class) { :Network }

    let(:params) do
      {
        :uuid => "nw-testuuid",
        :display_name => "test_name",
        :ipv4_network => "1.2.3.0",
        :prefix => 24,
        :editable => true
      }
    end

    describe "create_entry" do
      it "creates a record on the network table of the vnet" do
        subject.create_entry(model_class, params)
        entry = Vnet::Models::Network['nw-testuuid']

        expect(entry).not_to eq nil
        expect(entry[:uuid]).to eq "testuuid"
      end
    end
  end
end
